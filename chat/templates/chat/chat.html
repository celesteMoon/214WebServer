{% extends "base.html" %}

{% block title %}
    <title>聊天室</title>
{% endblock %}

{% block head %}
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'chat/css/time_tooltip.css' %}">    
{% endblock %}

{% block body %}
    <header> </header>

    <body onresize="resizeChatHistory()" onload="resizeChatHistory()">
        <h1>聊天室</h1>

        <div>
            <div id="online-users" style="margin: 0; padding: 0; overflow: hidden;"></div>
        </div>

        <div id="chat-log" style="height: 600px; overflow-y: auto;">
            <h2>消息记录</h2>
            {% for message in messages %}
                <p><strong>{{ message.username }}</strong>: {{ message.content }}</p>
            {% endfor %}
        </div>
    </body>

    <footer>
        <form id="chat-form">
            {% csrf_token %}
            <input type="text" id="username" value="{{ request.user.username }}" readonly style="display: none;">
            <textarea id="message-input" placeholder="输入你的消息"></textarea>
            <button type="submit">发送</button>
        </form>
    </footer>
{% endblock %}

{% block src %}
    {% load static %}
    <script src="{% static 'chat/js/time_tooltip.js' %}"></script>
    <script src="{% static 'chat/js/websocket.js' %}"></script>
    <script src="{% static 'chat/js/chat_history.js' %}"></script>
{% endblock %}
